---
title: "コンテナ仮想化 用語とユーティリティ"
date: 2024-07-18T19:18:01+09:00
---

### nsenter

#### 概要
`nsenter`は、既存のプロセスのネームスペースに入るためのコマンドです。これにより、他のプロセスと同じネームスペースで動作することができます。

#### 使用方法
- **プロセスIDを指定して、プロセスのネームスペースに入る**
  ```bash
  nsenter --target <pid> --mount --uts --ipc --net --pid -- su -
  ```

#### 主なオプション
- `--target <pid>`: 対象のプロセスID。
- `--mount`: マウントネームスペース。
- `--uts`: UTSネームスペース。
- `--ipc`: IPCネームスペース。
- `--net`: ネットワークネームスペース。
- `--pid`: プロセスIDネームスペース。

### unshare

#### 概要
`unshare`は、新しいネームスペースを作成し、そのネームスペース内でコマンドを実行するためのコマンドです。

#### 使用方法
- **新しいマウントネームスペースを作成**
  ```bash
  unshare --mount /bin/bash
  ```

#### 主なオプション
- `--mount`: 新しいマウントネームスペース。
- `--uts`: 新しいUTSネームスペース。
- `--ipc`: 新しいIPCネームスペース。
- `--net`: 新しいネットワークネームスペース。
- `--pid`: 新しいPIDネームスペース。
- `--user`: 新しいユーザーネームスペース。

### ip (関連するサブコマンドを含む)

#### 概要
`ip`コマンドは、ネットワーク設定を管理するためのツールです。ネットワークインターフェースの設定、ルーティング、トンネリングなどを行います。

#### 主なサブコマンド
- **ネットワークインターフェースの表示**
  ```bash
  ip link show
  ```
- **ネットワークインターフェースの設定**
  ```bash
  ip link set dev eth0 up
  ```
- **IPアドレスの設定**
  ```bash
  ip addr add 192.168.1.10/24 dev eth0
  ```
- **ルーティングテーブルの表示**
  ```bash
  ip route show
  ```
- **ルートの追加**
  ```bash
  ip route add default via 192.168.1.1
  ```

### capsh

#### 概要
`capsh`は、Linuxケイパビリティの設定や制御を行うためのツールです。プロセスに特定のケイパビリティを付与したり、削除したりできます。

#### 使用方法
- **特定のケイパビリティを付与してシェルを起動**
  ```bash
  capsh --caps="cap_net_admin+ep" -- /bin/bash
  ```

#### 主なオプション
- `--caps=<caps>`: 付与するケイパビリティ。
- `--drop=<caps>`: 削除するケイパビリティ。
- `--keep=<caps>`: 維持するケイパビリティ。
- `--print`: 現在のケイパビリティの状態を表示。

### /sys/fs/cgroups

#### 概要
`/sys/fs/cgroups`は、cgroups（コントロールグループ）ファイルシステムのマウントポイントです。ここで、プロセスのリソース使用を管理・監視します。

#### 使用方法
- **cgroupsの一覧を表示**
  ```bash
  ls /sys/fs/cgroups
  ```
- **CPU使用量の制限**
  ```bash
  echo 100000 > /sys/fs/cgroup/cpu/mygroup/cpu.cfs_quota_us
  ```

### /proc/[0-9]+/ns

#### 概要
`/proc/[0-9]+/ns`ディレクトリには、特定のプロセスのネームスペースに関する情報が含まれています。各ファイルはネームスペースの種類を表します。

#### 使用方法
- **特定のプロセスのネームスペース情報を表示**
  ```bash
  ls -l /proc/<pid>/ns
  ```

#### 主なファイル
- `ipc`: IPCネームスペース。
- `mnt`: マウントネームスペース。
- `net`: ネットワークネームスペース。
- `pid`: PIDネームスペース。
- `user`: ユーザーネームスペース。
- `uts`: UTSネームスペース。

### /proc/[0-9]+/status

#### 概要
`/proc/[0-9]+/status`ファイルには、特定のプロセスのステータス情報が含まれています。プロセスID、ユーザーID、グループID、メモリ使用量などの情報が記載されています。

#### 使用方法
- **特定のプロセスのステータス情報を表示**
  ```bash
  cat /proc/<pid>/status
  ```

#### 主なフィールド
- `Name`: プロセス名。
- `State`: プロセスの状態。
- `Pid`: プロセスID。
- `PPid`: 親プロセスID。
- `Uid`: 実効ユーザーID。
- `Gid`: 実効グループID。
- `VmSize`: 仮想メモリサイズ。
- `VmRSS`: 常駐セットサイズ。

これらのツールとファイルは、コンテナ仮想化環境でのプロセス、リソース、セキュリティの管理に不可欠です。
